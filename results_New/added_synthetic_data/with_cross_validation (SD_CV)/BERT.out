Total synthetic samples: 4368
Map:   0%|          | 0/9171 [00:00<?, ? examples/s]Map:  22%|██▏       | 2000/9171 [00:00<00:01, 4915.38 examples/s]Map:  44%|████▎     | 4000/9171 [00:00<00:00, 7441.77 examples/s]Map:  55%|█████▍    | 5000/9171 [00:00<00:00, 7748.74 examples/s]Map:  87%|████████▋ | 8000/9171 [00:00<00:00, 12993.92 examples/s]Map: 100%|██████████| 9171/9171 [00:00<00:00, 10591.06 examples/s]
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Fold 1/3 - Training set size: 6114, Validation set size: 1621
Flattening the indices:   0%|          | 0/6114 [00:00<?, ? examples/s]Flattening the indices:  82%|████████▏ | 5000/6114 [00:00<00:00, 42546.69 examples/s]Flattening the indices: 100%|██████████| 6114/6114 [00:00<00:00, 40216.32 examples/s]
Flattening the indices:   0%|          | 0/1621 [00:00<?, ? examples/s]Flattening the indices: 100%|██████████| 1621/1621 [00:00<00:00, 68500.68 examples/s]
Accuracy Fold 1: 0.8976
Total time taken (training + evaluation) Fold 1: 251.30 seconds
GPU memory used Fold 1: 866.32 MB
Validation Classification Report Fold 1:
                precision    recall  f1-score   support

    open-ended       0.93      0.92      0.92       480
 option-posing       0.92      0.88      0.90       764
none-questions       0.77      0.92      0.84       188
       leading       0.88      0.88      0.88       189

      accuracy                           0.90      1621
     macro avg       0.87      0.90      0.88      1621
  weighted avg       0.90      0.90      0.90      1621

Confusion matrix saved to /work/nikki/CM_BERT_Fold 1.png
Fold 2/3 - Training set size: 6114, Validation set size: 1584
Flattening the indices:   0%|          | 0/6114 [00:00<?, ? examples/s]Flattening the indices:  82%|████████▏ | 5000/6114 [00:00<00:00, 40862.07 examples/s]Flattening the indices: 100%|██████████| 6114/6114 [00:00<00:00, 38663.12 examples/s]
Flattening the indices:   0%|          | 0/1584 [00:00<?, ? examples/s]Flattening the indices: 100%|██████████| 1584/1584 [00:00<00:00, 67894.80 examples/s]
Accuracy Fold 2: 0.9665
Total time taken (training + evaluation) Fold 2: 251.21 seconds
GPU memory used Fold 2: -3.29 MB
Validation Classification Report Fold 2:
                precision    recall  f1-score   support

    open-ended       0.98      0.97      0.97       446
 option-posing       0.98      0.96      0.97       765
none-questions       0.87      0.98      0.92       177
       leading       0.98      0.97      0.98       196

      accuracy                           0.97      1584
     macro avg       0.95      0.97      0.96      1584
  weighted avg       0.97      0.97      0.97      1584

Confusion matrix saved to /work/nikki/CM_BERT_Fold 2.png
Fold 3/3 - Training set size: 6114, Validation set size: 1598
Flattening the indices:   0%|          | 0/6114 [00:00<?, ? examples/s]Flattening the indices:  82%|████████▏ | 5000/6114 [00:00<00:00, 42006.39 examples/s]Flattening the indices: 100%|██████████| 6114/6114 [00:00<00:00, 39488.05 examples/s]
Flattening the indices:   0%|          | 0/1598 [00:00<?, ? examples/s]Flattening the indices: 100%|██████████| 1598/1598 [00:00<00:00, 67871.33 examples/s]
Accuracy Fold 3: 0.9887
Total time taken (training + evaluation) Fold 3: 250.99 seconds
GPU memory used Fold 3: 0.43 MB
Validation Classification Report Fold 3:
                precision    recall  f1-score   support

    open-ended       0.99      0.99      0.99       464
 option-posing       0.99      0.99      0.99       764
none-questions       0.96      0.99      0.98       179
       leading       0.99      1.00      0.99       191

      accuracy                           0.99      1598
     macro avg       0.98      0.99      0.99      1598
  weighted avg       0.99      0.99      0.99      1598

Confusion matrix saved to /work/nikki/CM_BERT_Fold 3.png
Total time taken (training + evaluation) all folds: 755.06 seconds
GPU memory used all folds: 863.45 MB

Average Accuracy across all folds: 0.9510
