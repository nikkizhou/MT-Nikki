Map:   0%|          | 0/4803 [00:00<?, ? examples/s]Map:  62%|██████▏   | 3000/4803 [00:00<00:00, 21323.36 examples/s]Map: 100%|██████████| 4803/4803 [00:00<00:00, 8134.41 examples/s] 
Some weights of DistilBertForSequenceClassification were not initialized from the model checkpoint at distilbert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight', 'pre_classifier.bias', 'pre_classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Fold 1/3 - Training set size: 3202, Validation set size: 1601
Flattening the indices:   0%|          | 0/3202 [00:00<?, ? examples/s]Flattening the indices: 100%|██████████| 3202/3202 [00:00<00:00, 56685.29 examples/s]
Flattening the indices:   0%|          | 0/1601 [00:00<?, ? examples/s]Flattening the indices: 100%|██████████| 1601/1601 [00:00<00:00, 95753.26 examples/s]
Accuracy Fold 1: 0.9182
Total time taken (training + evaluation): 84.79 seconds
GPU memory used: 530.78 MB
Validation Classification Report Fold 1:
                precision    recall  f1-score   support

    open-ended       0.90      0.94      0.92       464
 option-posing       0.94      0.91      0.92       764
none-questions       0.89      0.90      0.89       181
       leading       0.90      0.92      0.91       192

      accuracy                           0.92      1601
     macro avg       0.91      0.92      0.91      1601
  weighted avg       0.92      0.92      0.92      1601

Confusion matrix saved to /work/nikki/CM_DistilBert_Fold 1.png
Fold 2/3 - Training set size: 3202, Validation set size: 1601
Flattening the indices:   0%|          | 0/3202 [00:00<?, ? examples/s]Flattening the indices: 100%|██████████| 3202/3202 [00:00<00:00, 59679.00 examples/s]
Flattening the indices:   0%|          | 0/1601 [00:00<?, ? examples/s]Flattening the indices: 100%|██████████| 1601/1601 [00:00<00:00, 93665.69 examples/s]
Early stopping triggered at epoch 3
Accuracy Fold 2: 0.9538
Total time taken (training + evaluation): 83.51 seconds
GPU memory used: 3.93 MB
Validation Classification Report Fold 2:
                precision    recall  f1-score   support

    open-ended       0.97      0.95      0.96       463
 option-posing       0.96      0.95      0.96       765
none-questions       0.90      0.95      0.92       181
       leading       0.94      0.97      0.96       192

      accuracy                           0.95      1601
     macro avg       0.94      0.96      0.95      1601
  weighted avg       0.95      0.95      0.95      1601

Confusion matrix saved to /work/nikki/CM_DistilBert_Fold 2.png
Fold 3/3 - Training set size: 3202, Validation set size: 1601
Flattening the indices:   0%|          | 0/3202 [00:00<?, ? examples/s]Flattening the indices: 100%|██████████| 3202/3202 [00:00<00:00, 57724.91 examples/s]
Flattening the indices:   0%|          | 0/1601 [00:00<?, ? examples/s]Flattening the indices: 100%|██████████| 1601/1601 [00:00<00:00, 88630.38 examples/s]
Accuracy Fold 3: 0.9875
Total time taken (training + evaluation): 83.54 seconds
GPU memory used: -3.12 MB
Validation Classification Report Fold 3:
                precision    recall  f1-score   support

    open-ended       0.98      0.99      0.99       463
 option-posing       0.99      0.98      0.99       764
none-questions       0.96      1.00      0.98       182
       leading       1.00      0.99      1.00       192

      accuracy                           0.99      1601
     macro avg       0.98      0.99      0.99      1601
  weighted avg       0.99      0.99      0.99      1601

Confusion matrix saved to /work/nikki/CM_DistilBert_Fold 3.png
Total time taken (training + evaluation) all folds: 253.05 seconds
GPU memory used all folds: 531.58 MB

Average Accuracy across all folds: 0.9532
